<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Geheimes Wort Spiel Multiplayer</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #e8f5e9; text-align: center;}
  #wordDisplay { margin: 20px; font-size: 1.2em; font-weight: bold; }
  button { padding: 10px 15px; margin: 10px; font-size: 1em; }
</style>
</head>
<body>

<h1>Geheimes Wort Spiel (Multiplayer)</h1>

<div id="login">
  <input id="nameInput" placeholder="Dein Name" />
  <button id="joinBtn">Spiel beitreten</button>
</div>

<div id="game" style="display:none;">
  <p>Spieler: <span id="playersList"></span></p>
  <p>Aktueller Spieler: <span id="currentPlayer"></span></p>

  <label for="imposterCount">Anzahl Imposter:</label>
  <select id="imposterCount">
    <option>0</option><option>1</option><option>2</option>
  </select>
  <button id="startGameBtn">Spiel starten</button>

  <div>
    <button id="showWordBtn" disabled>Wort anzeigen</button>
  </div>

  <div id="wordDisplay"></div>
  <div id="status"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();

  const loginDiv = document.getElementById('login');
  const gameDiv = document.getElementById('game');
  const nameInput = document.getElementById('nameInput');
  const joinBtn = document.getElementById('joinBtn');
  const playersList = document.getElementById('playersList');
  const currentPlayer = document.getElementById('currentPlayer');
  const imposterCountSelect = document.getElementById('imposterCount');
  const startGameBtn = document.getElementById('startGameBtn');
  const showWordBtn = document.getElementById('showWordBtn');
  const wordDisplay = document.getElementById('wordDisplay');
  const statusDiv = document.getElementById('status');

  let playerName = "";
  let gameStarted = false;

  joinBtn.onclick = () => {
    if(!nameInput.value.trim()) {
      alert("Bitte gib deinen Namen ein.");
      return;
    }
    playerName = nameInput.value.trim();
    socket.emit('joinGame', playerName);
    loginDiv.style.display = 'none';
    gameDiv.style.display = 'block';
  };

  socket.on('playersUpdate', (players) => {
    playersList.textContent = players.join(', ');
  });

  startGameBtn.onclick = () => {
    const imposterCount = parseInt(imposterCountSelect.value);
    socket.emit('startGame', imposterCount);
  };

  socket.on('errorMessage', msg => alert(msg));

  socket.on('gameStarted', () => {
    alert("Das Spiel lÃ¤uft bereits!");
  });

  socket.on('gameStartedServer', () => {
    gameStarted = true;
    statusDiv.textContent = "Spiel gestartet! Warte auf deinen Zug.";
    showWordBtn.disabled = false;
  });

  socket.on('currentPlayer', (name) => {
    currentPlayer.textContent = name;
    if(name === playerName) {
      statusDiv.textContent = "Du bist dran! Klicke auf 'Wort anzeigen'.";
      showWordBtn.disabled = false;
      wordDisplay.textContent = "";
    } else {
      statusDiv.textContent = `Warte auf Spieler ${name}...`;
      showWordBtn.disabled = true;
      wordDisplay.textContent = "";
    }
  });

  showWordBtn.onclick = () => {
    socket.emit('showWord');
  };

  socket.on('yourWord', (word) => {
    wordDisplay.textContent = `Dein Wort: ${word}`;
  });

  socket.on('gameOver', () => {
    statusDiv.textContent = "Alle Spieler haben ihr Wort gesehen. Spiel vorbei!";
    showWordBtn.disabled = true;
  });
</script>

</body>
</html>
